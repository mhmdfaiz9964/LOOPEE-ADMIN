
# RECENT CHANGES & API KEY IMPLEMENTATION GUIDE

## 1. RECENT CHANGES: STORE & CATEGORY TYPES (GROCERY / FOOD)

We have successfully implemented a system to distinguish both **Stores** and **Categories** by type: **Grocery** or **Food**. This allows for clear segregation within the app (e.g., separate flows for ordering food vs. buying groceries).

### A. Changes in Stores (Vendors)
- **Create/Edit Store**: Added a "Type" dropdown menu. Admins must select "Grocery" or "Food" when onboarding a vendor.
- **Default Settings**: New stores now default to **Sri Lanka (+94)** for the phone country code.
- **Store List UI**: The list view now features **Visual Badges** for easy identification:
    - **Grocery**: Green Badge with a Shopping Cart icon (<i class="mdi mdi-cart-outline"></i>).
    - **Food**: Orange Badge with a Food icon (<i class="mdi mdi-food"></i>).
- **Store Details**: The "View Store" page now explicitly lists the assigned Store Type.

### B. Changes in Categories
- **Management**: Similar to stores, Categories now require a "Type" selection during creation or editing.
- **Category List UI**: Updated to use the same **Visual Badges** as the store list for consistency (Green/Cart for Grocery, Orange/Food for Food).
- **Auto-Assign Utility**: A temporary "Auto Assign Types" button was added to the **Dashboard**. This tool backfills existing stores and categories with random types if they were missing, ensuring the new feature works with legacy data.

### How It Works:
1.  **Data Structure**: Both `vendors` and `vendor_categories` collections in Firestore now have a `type` string field ('grocery' or 'food').
2.  **Visual Indicators**: The Admin Panel uses this field to render specific badges, helping admins quickly scan lists.
3.  **App Filtering**: The user-facing app can query `where('type', '==', 'food')` or `where('type', '==', 'grocery')` to show relevant content in the appropriate tabs.
---

## 2. API KEYS IMPLEMENTATION

The application uses various API keys (Google Maps, Firebase, Payment Gateways) which are managed directly through the Admin Panel's settings. These keys are stored in the Firestore database (`settings` collection) and fetched by the app as needed.

### A. Google Maps API Key
This key is used for map rendering, location picking, and direction services.
1.  **Navigate to**: Admin Panel > Settings > Global Settings.
2.  **Locate Section**: "Google Map API Key" (usually at the bottom or middle of the page).
3.  **Input**: Enter your Google Maps API Key in the field provided.
4.  **Save**: Click the "Save" button.
    *   *Backend Action*: This updates the `settings/googleMapKey` document in Firestore.
    *   *App Usage*: The mobile/web apps fetch this document to initialize the Google Maps SDK.

### B. Firebase Cloud Messaging (FCM) / Notifications
For push notifications to work (e.g., order updates), you need to configure FCM.
1.  **Navigate to**: Admin Panel > Settings > Notification Settings.
2.  **Sender ID**: Enter your Firebase Sender ID.
3.  **Service JSON**: Upload the `firebase-service-account.json` file (generated from Firebase Console > Project Settings > Service Accounts).
4.  **Save**: This securely stores the credentials to allow the server to send notifications.

### C. Payment Gateway Keys (Stripe, PayPal, etc.)
1.  **Navigate to**: Admin Panel > Settings > Payment Settings.
2.  **Select Gateway**: Choose the payment method (e.g., Stripe, Razorpay).
3.  **Input Keys**: Enter the Public/Publishable Key and Secret Key provided by your payment processor.
4.  **Toggle**: Enable the payment method and optionally "Sandbox Mode" for testing.
5.  **Save**: These keys are stored in Firestore for the app to process payments securely.

### D. General Firebase Config
The Admin Panel itself connects to Firebase using a configuration that is typically found in the code (often in `js/config.js` or `layouts/app.blade.php`), or sometimes dynamically loaded. If you need to change the project the Admin Panel connects to, you would update the Firebase initialization snippet with your new project's `apiKey`, `authDomain`, `projectId`, etc.
